# テスト仕様書（Test Specification）

## 0. 本資料の位置づけ
- 本資料は、Unyte Wallet における各機能に対するテスト観点・確認内容を一覧化したものです。
- `test-plan.md` の試験方針をもとに、実施すべき項目を明確化します。

---

## 1. 機能別テスト観点一覧

---

### F01 ログイン機能

| No. | 観点                     | 確認内容                                     | 期待動作                                 | 対応画面 / API         |
|-----|--------------------------|----------------------------------------------|------------------------------------------|-------------------------|
| 1-1 | 正常系：LINEログイン     | LINEログインボタンを押下 → トークン発行     | Firebase認証成功し、JWT発行              | S01 / /auth/login       |
| 1-2 | 正常系：Googleログイン   | Googleアカウント選択 → ログイン完了         | ユーザー情報が作成され、ホームに遷移     | S01                     |
| 1-3 | 異常系：トークン不正     | 無効なIDトークンを送信                       | エラーが表示され、画面は遷移しない       | S01                     |
| 1-4 | UI表示                   | 認証中はローディングUIが表示される           | ログイン中の状態を明示                   | S01                     |

---

### F02 トークン残高表示

| No. | 観点                   | 確認内容                               | 期待動作                                 | 対応画面 / API         |
|-----|------------------------|----------------------------------------|------------------------------------------|-------------------------|
| 2-1 | 正常系：残高取得       | 有効なアドレスを入力                  | 保有しているERC20トークンが正しく表示   | S02 / /balance/:address |
| 2-2 | 異常系：アドレス不正   | 無効なアドレス形式でリクエスト         | 「アドレスが不正です」と表示            | S02                     |
| 2-3 | 非保有状態             | トークン残高が0の場合                  | 「保有しているトークンはありません」と表示 | S02                     |

---

### F03 トランザクション提案

| No. | 観点                     | 確認内容                                        | 期待動作                              | 対応画面 / API   |
|-----|--------------------------|-------------------------------------------------|---------------------------------------|-------------------|
| 3-1 | 正常系：提案作成         | 宛先・金額を入力して「提案」実行               | Gnosis提案が作成され、DBに記録される | S03 / /tx/propose |
| 3-2 | バリデーション           | 金額に0以下や無効な値を入力                     | 入力エラーが表示されて送信できない   | S03               |
| 3-3 | UI：入力制御             | 桁数制限・形式制御がされている                 | 桁あふれ・形式ミスが未然に防がれる   | S03               |
| 3-4 | 通知処理                 | 提案後、署名者に通知が送信される               | メール/FCM通知が届く                  | -                 |

---

### F04 署名・実行フロー

| No. | 観点                   | 確認内容                                          | 期待動作                                | 対応画面 / API |
|-----|------------------------|---------------------------------------------------|-----------------------------------------|-----------------|
| 4-1 | 正常系：署名           | 承認ボタン押下で署名を送信                       | Enclaveで署名処理 → Gnosisに反映       | S04 / /tx/sign  |
| 4-2 | 異常系：Enclave失敗    | Enclave署名処理でタイムアウト                    | エラーメッセージが表示される            | S04             |
| 4-3 | ステータス更新         | 閾値到達で自動的に「実行中」→「完了」に変化     | UIとDBで一致                            | S04 / S05       |

---

## 2. 共通テスト観点

| No. | 観点         | 内容                                 | 備考                       |
|-----|--------------|--------------------------------------|----------------------------|
| C-1 | 通信エラー系 | APIタイムアウト時のエラーハンドリング | メッセージ＋リトライ可否を確認 |
| C-2 | 認証         | 有効期限切れJWTの挙動                | `/auth/login` から再取得     |
| C-3 | 表示崩れ     | 各画面でスマホ／PCにおけるUI確認      | 横幅320px以上を対象         |

---

## 3. 非機能テスト観点（抜粋）

| No. | 観点             | 内容                                      | 対象                   |
|-----|------------------|-------------------------------------------|------------------------|
| N-1 | パフォーマンス     | `/balance/:address` の応答速度が1秒以内   | 高負荷時も確認         |
| N-2 | セキュリティ       | JWT改ざん試験                             | API認証ヘッダー         |
| N-3 | アクセシビリティ   | ボタン操作、フォーカス制御、ARIA属性など | 全画面対象             |

---

## 4. 今後追加予定の観点

| 対象機能 | 内容                     | 状態     |
|----------|--------------------------|----------|
| Admin画面 | ユーザー検索の絞り込み等 | 実装後追加予定 |

---

## 5. 関連資料
- [test-plan.md](./test-plan.md)
- [validation-rules.md](./validation-rules.md)
- [function-design.md](../basic/function-design.md)
- [screen-design.md](../basic/screen-design.md)
